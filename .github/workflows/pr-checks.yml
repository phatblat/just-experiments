#
# .github/workflows/pr-checks.yml
#
# https://docs.github.com/en/actions/reference/environment-variables#default-environment-variables
---
name: pr-checks
on:
  pull_request:
    branches: [main]
  push:
    branches: [main]
# https://docs.github.com/en/actions/using-jobs/using-concurrency
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true
jobs:
  lint:
    runs-on: macos-14
    defaults:
      run:
        shell: bash
    steps:
      - name: ðŸ“² Install Tools
        run: |
          if [[ ! -x "$(command -v mise)" ]]; then
            curl --no-progress-meter https://mise.jdx.dev/install.sh | sh
          fi
          which mise
          mise settings set experimental true
          mise install --verbose
          mise list --verbose
          echo 'eval "$(mise activate bash)"' >> ~/.bashrc
          eval (mise hook-env --shell=fish)
          # MISE is installed to ~/bin/mise
          if [[ -x "$HOME/bin/mise" ]]; then
            export PATH="$HOME/bin:$PATH"
            # hook-env command primes even non-interactive shells
            eval "$(mise hook-env --shell=bash)"
          fi
      - uses: actions/checkout@v4
      - name: ðŸš¨ Lint
        run: just lint
