#
# .github/workflows/pr-checks.yml
#
# https://docs.github.com/en/actions/reference/environment-variables#default-environment-variables
---
name: pr-checks
on:
  pull_request:
    branches: [main]
  push:
    branches: [main]
# https://docs.github.com/en/actions/using-jobs/using-concurrency
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true
jobs:
  lint:
    runs-on: macos-14
    defaults:
      run:
        shell: bash
    steps:
      - name: ğŸ“² Install `mise`
        run: |
          if [[ ! -x "$(command -v mise)" ]]; then
            curl --no-progress-meter https://mise.jdx.dev/install.sh | sh
          fi
          if [[ ! -x "~/.local/bin/mise" ]]; then
            echo "~/.local/bin/mise is not executable!"
            return 1
          fi
          echo 'export PATH="~.local/bin:$PATH";' >> ~/.bashrc
          echo 'eval "$(mise hook-env --shell=bash)"' >> ~/.bashrc
      - name: ğŸ“² Install `just`
        run: |
          which mise
          mise settings set experimental true
          mise install --verbose
          mise list --verbose
      - uses: actions/checkout@v4
      - name: ğŸš¨ Lint
        run: just lint
